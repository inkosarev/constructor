(function(){const L=document.createElement("link").relList;if(L&&L.supports&&L.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))U(h);new MutationObserver(h=>{for(const y of h)if(y.type==="childList")for(const I of y.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&U(I)}).observe(document,{childList:!0,subtree:!0});function a(h){const y={};return h.integrity&&(y.integrity=h.integrity),h.referrerpolicy&&(y.referrerPolicy=h.referrerpolicy),h.crossorigin==="use-credentials"?y.credentials="include":h.crossorigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function U(h){if(h.ep)return;h.ep=!0;const y=a(h);fetch(h.href,y)}})();var $={exports:{}};(function(m){(function(L){var a=oe(),U=ie(),h=ae(),y=ue(),I={imagePlaceholder:void 0,cacheBust:!1},q={toSvg:X,toPng:Q,toJpeg:Y,toBlob:Z,toPixelData:K,impl:{fontFaces:h,images:y,util:a,inliner:U,options:{}}};m.exports=q;function X(n,t){return t=t||{},ee(t),Promise.resolve(n).then(function(i){return G(i,t.filter,!0)}).then(te).then(ne).then(r).then(function(i){return re(i,t.width||a.width(n),t.height||a.height(n))});function r(i){return t.bgcolor&&(i.style.backgroundColor=t.bgcolor),t.width&&(i.style.width=t.width+"px"),t.height&&(i.style.height=t.height+"px"),t.style&&Object.keys(t.style).forEach(function(s){i.style[s]=t.style[s]}),i}}function K(n,t){return O(n,t||{}).then(function(r){return r.getContext("2d").getImageData(0,0,a.width(n),a.height(n)).data})}function Q(n,t){return O(n,t||{}).then(function(r){return r.toDataURL()})}function Y(n,t){return t=t||{},O(n,t).then(function(r){return r.toDataURL("image/jpeg",t.quality||1)})}function Z(n,t){return O(n,t||{}).then(a.canvasToBlob)}function ee(n){typeof n.imagePlaceholder>"u"?q.impl.options.imagePlaceholder=I.imagePlaceholder:q.impl.options.imagePlaceholder=n.imagePlaceholder,typeof n.cacheBust>"u"?q.impl.options.cacheBust=I.cacheBust:q.impl.options.cacheBust=n.cacheBust}function O(n,t){return X(n,t).then(a.makeImage).then(a.delay(100)).then(function(i){var s=r(n);return s.getContext("2d").drawImage(i,0,0),s});function r(i){var s=document.createElement("canvas");if(s.width=t.width||a.width(i),s.height=t.height||a.height(i),t.bgcolor){var l=s.getContext("2d");l.fillStyle=t.bgcolor,l.fillRect(0,0,s.width,s.height)}return s}}function G(n,t,r){if(!r&&t&&!t(n))return Promise.resolve();return Promise.resolve(n).then(i).then(function(o){return s(n,o,t)}).then(function(o){return l(n,o)});function i(o){return o instanceof HTMLCanvasElement?a.makeImage(o.toDataURL()):o.cloneNode(!1)}function s(o,u,w){var E=o.childNodes;if(E.length===0)return Promise.resolve(u);return g(u,a.asArray(E),w).then(function(){return u});function g(B,P,p){var S=Promise.resolve();return P.forEach(function(C){S=S.then(function(){return G(C,p)}).then(function(b){b&&B.appendChild(b)})}),S}}function l(o,u){if(!(u instanceof Element))return u;return Promise.resolve().then(w).then(E).then(g).then(B).then(function(){return u});function w(){P(window.getComputedStyle(o),u.style);function P(p,S){p.cssText?S.cssText=p.cssText:C(p,S);function C(b,x){a.asArray(b).forEach(function(e){x.setProperty(e,b.getPropertyValue(e),b.getPropertyPriority(e))})}}}function E(){[":before",":after"].forEach(function(p){P(p)});function P(p){var S=window.getComputedStyle(o,p),C=S.getPropertyValue("content");if(C===""||C==="none")return;var b=a.uid();u.className=u.className+" "+b;var x=document.createElement("style");x.appendChild(e(b,p,S)),u.appendChild(x);function e(c,d,f){var v="."+c+":"+d,A=f.cssText?j(f):M(f);return document.createTextNode(v+"{"+A+"}");function j(F){var T=F.getPropertyValue("content");return F.cssText+" content: "+T+";"}function M(F){return a.asArray(F).map(T).join("; ")+";";function T(R){return R+": "+F.getPropertyValue(R)+(F.getPropertyPriority(R)?" !important":"")}}}}}function g(){o instanceof HTMLTextAreaElement&&(u.innerHTML=o.value),o instanceof HTMLInputElement&&u.setAttribute("value",o.value)}function B(){u instanceof SVGElement&&(u.setAttribute("xmlns","http://www.w3.org/2000/svg"),u instanceof SVGRectElement&&["width","height"].forEach(function(P){var p=u.getAttribute(P);!p||u.style.setProperty(P,p)}))}}}function te(n){return h.resolveAll().then(function(t){var r=document.createElement("style");return n.appendChild(r),r.appendChild(document.createTextNode(t)),n})}function ne(n){return y.inlineAll(n).then(function(){return n})}function re(n,t,r){return Promise.resolve(n).then(function(i){return i.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(i)}).then(a.escapeXhtml).then(function(i){return'<foreignObject x="0" y="0" width="100%" height="100%">'+i+"</foreignObject>"}).then(function(i){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+r+'">'+i+"</svg>"}).then(function(i){return"data:image/svg+xml;charset=utf-8,"+i})}function oe(){return{escape:B,parseExtension:t,mimeType:r,dataAsUrl:g,isDataUrl:i,canvasToBlob:l,resolveUrl:o,getAndEncode:E,uid:u(),delay:P,asArray:p,escapeXhtml:S,makeImage:w,width:C,height:b};function n(){var e="application/font-woff",c="image/jpeg";return{woff:e,woff2:e,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:c,jpeg:c,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function t(e){var c=/\.([^\.\/]*?)$/g.exec(e);return c?c[1]:""}function r(e){var c=t(e).toLowerCase();return n()[c]||""}function i(e){return e.search(/^(data:)/)!==-1}function s(e){return new Promise(function(c){for(var d=window.atob(e.toDataURL().split(",")[1]),f=d.length,v=new Uint8Array(f),A=0;A<f;A++)v[A]=d.charCodeAt(A);c(new Blob([v],{type:"image/png"}))})}function l(e){return e.toBlob?new Promise(function(c){e.toBlob(c)}):s(e)}function o(e,c){var d=document.implementation.createHTMLDocument(),f=d.createElement("base");d.head.appendChild(f);var v=d.createElement("a");return d.body.appendChild(v),f.href=c,v.href=e,v.href}function u(){var e=0;return function(){return"u"+c()+e++;function c(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function w(e){return new Promise(function(c,d){var f=new Image;f.onload=function(){c(f)},f.onerror=d,f.src=e})}function E(e){var c=3e4;return q.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime()),new Promise(function(d){var f=new XMLHttpRequest;f.onreadystatechange=j,f.ontimeout=M,f.responseType="blob",f.timeout=c,f.open("GET",e,!0),f.send();var v;if(q.impl.options.imagePlaceholder){var A=q.impl.options.imagePlaceholder.split(/,/);A&&A[1]&&(v=A[1])}function j(){if(f.readyState===4){if(f.status!==200){v?d(v):F("cannot fetch resource: "+e+", status: "+f.status);return}var T=new FileReader;T.onloadend=function(){var R=T.result.split(/,/)[1];d(R)},T.readAsDataURL(f.response)}}function M(){v?d(v):F("timeout of "+c+"ms occured while fetching resource: "+e)}function F(T){console.error(T),d("")}})}function g(e,c){return"data:"+c+";base64,"+e}function B(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function P(e){return function(c){return new Promise(function(d){setTimeout(function(){d(c)},e)})}}function p(e){for(var c=[],d=e.length,f=0;f<d;f++)c.push(e[f]);return c}function S(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")}function C(e){var c=x(e,"border-left-width"),d=x(e,"border-right-width");return e.scrollWidth+c+d}function b(e){var c=x(e,"border-top-width"),d=x(e,"border-bottom-width");return e.scrollHeight+c+d}function x(e,c){var d=window.getComputedStyle(e).getPropertyValue(c);return parseFloat(d.replace("px",""))}}function ie(){var n=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:s,shouldProcess:t,impl:{readUrls:r,inline:i}};function t(l){return l.search(n)!==-1}function r(l){for(var o=[],u;(u=n.exec(l))!==null;)o.push(u[1]);return o.filter(function(w){return!a.isDataUrl(w)})}function i(l,o,u,w){return Promise.resolve(o).then(function(g){return u?a.resolveUrl(g,u):g}).then(w||a.getAndEncode).then(function(g){return a.dataAsUrl(g,a.mimeType(o))}).then(function(g){return l.replace(E(o),"$1"+g+"$3")});function E(g){return new RegExp(`(url\\(['"]?)(`+a.escape(g)+`)(['"]?\\))`,"g")}}function s(l,o,u){if(w())return Promise.resolve(l);return Promise.resolve(l).then(r).then(function(E){var g=Promise.resolve(l);return E.forEach(function(B){g=g.then(function(P){return i(P,B,o,u)})}),g});function w(){return!t(l)}}}function ae(){return{resolveAll:n,impl:{readAll:t}};function n(){return t().then(function(r){return Promise.all(r.map(function(i){return i.resolve()}))}).then(function(r){return r.join(`
`)})}function t(){return Promise.resolve(a.asArray(document.styleSheets)).then(i).then(r).then(function(l){return l.map(s)});function r(l){return l.filter(function(o){return o.type===CSSRule.FONT_FACE_RULE}).filter(function(o){return U.shouldProcess(o.style.getPropertyValue("src"))})}function i(l){var o=[];return l.forEach(function(u){try{a.asArray(u.cssRules||[]).forEach(o.push.bind(o))}catch(w){console.log("Error while reading CSS rules from "+u.href,w.toString())}}),o}function s(l){return{resolve:function(){var u=(l.parentStyleSheet||{}).href;return U.inlineAll(l.cssText,u)},src:function(){return l.style.getPropertyValue("src")}}}}}function ue(){return{inlineAll:t,impl:{newImage:n}};function n(r){return{inline:i};function i(s){return a.isDataUrl(r.src)?Promise.resolve():Promise.resolve(r.src).then(s||a.getAndEncode).then(function(l){return a.dataAsUrl(l,a.mimeType(r.src))}).then(function(l){return new Promise(function(o,u){r.onload=o,r.onerror=u,r.src=l})})}}function t(r){if(!(r instanceof Element))return Promise.resolve(r);return i(r).then(function(){return r instanceof HTMLImageElement?n(r).inline():Promise.all(a.asArray(r.childNodes).map(function(s){return t(s)}))});function i(s){var l=s.style.getPropertyValue("background");return l?U.inlineAll(l).then(function(o){s.style.setProperty("background",o,s.style.getPropertyPriority("background"))}).then(function(){return s}):Promise.resolve(s)}}}})()})($);const ce=$.exports,k={};let W="";const _=document.querySelector("#wrapper"),z=document.querySelector(".form"),D=document.querySelector("#image"),le=document.querySelector("#render"),J=document.querySelector(".save"),V=document.querySelector(".edit"),N={headField:document.querySelector("#head"),nameField:document.querySelector("#name"),ageField:document.querySelector("#age"),dateField:document.querySelector("#date"),placeField:document.querySelector("#place"),wearField:document.querySelector("#wear"),omensField:document.querySelector("#omens"),footerNameField:document.querySelector("#footer-name"),fileField:document.querySelector("#file")},H={headField:document.querySelector(".header"),nameField:document.querySelector(".name"),ageField:document.querySelector(".age"),dateField:document.querySelector(".date"),placeField:document.querySelector(".place"),omensField:document.querySelector(".omens"),wearField:document.querySelector(".wear"),footerNameField:document.querySelector(".subname"),photo:document.querySelector("#photo")};J.addEventListener("click",()=>{const m=document.createElement("a");m.download="my-image-name.jpeg",m.href=W,m.click(),document.removeChild(m)});V.addEventListener("click",()=>{z.style.display="block",D.style.display="none",D.style.width="auto",V.style.display="none",J.style.display="none"});Object.keys(N).forEach(m=>{m!=="fileField"&&N[m].addEventListener("input",L=>{k[m]=N[m].value,localStorage.setItem("_spasFormData",JSON.stringify(k))})});const se=()=>{Object.keys(H).forEach(m=>{m!=="fileField"&&(H[m].innerText=k[m]||"")})};le.addEventListener("click",()=>{se(),z.style.display="none",D.style.display="block",_.style.display="flex",V.style.display="block",J.style.display="block",ce.toJpeg(document.querySelector("#wrapper"),{bgcolor:"#ffffff",quality:.95}).then(m=>{D.src=m,W=m,_.style.display="none",D.style.width="100%"})});N.fileField.addEventListener("change",m=>{const L=m.target.files[0],a=new FileReader;a.readAsDataURL(L),a.onload=()=>{H.photo.src=a.result,k.fileField=a.result,localStorage.setItem("_spasFormData",JSON.stringify(k))}});
